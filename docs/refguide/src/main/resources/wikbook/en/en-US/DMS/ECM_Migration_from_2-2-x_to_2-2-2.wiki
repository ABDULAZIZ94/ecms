
h1. ECM Migration from 2-2-x to 2-2-2




h1. Update a pom.xml

Update the pom.xml at the location web/ecmportal/

In ECM 2.2.2 we changed the pom.xml to make war overlay work better.
{code}
  <dependentWarExcludes>
    index.jsp,WEB-INF/web.xml,WEB-INF/conf/*.xml,
    WEB-INF/conf/common/*.xml,
    WEB-INF/conf/database/*.xml,
    WEB-INF/conf/database/*.xml,
    WEB-INF/conf/jcr/*.xml,
    WEB-INF/conf/organization/*.xml,
    WEB-INF/conf/portal/*.xml,
    WEB-INF/conf/portal/group/,
    WEB-INF/conf/portal/portal/,
    WEB-INF/conf/portal/user/,
    WEB-INF/classes/locale/navigation/,
    WEB-INF/conf/script/groovy/SkinConfigScript.groovy,
    templates/groovy/webui/component/UIHomePagePortlet.gtmpl,
    templates/skin/webui/component/UIHomePagePortlet/
  </dependentWarExcludes>
{code}

h1. Update the application-registry-configuration.xml
	
Update the application-registry-configuration.xml located at web/ecmportal/src/main/webapp/WEB-INF/conf/portal.

In ECM 2.2.2 we changed the configuration to define the dashboard as the default portlet.
{code}
<object-param>
    <name>dashboard</name>
    <description>description</description>
    <object type="org.exoplatform.application.registry.ApplicationCategory">
      <field name="name"><string>dashboard</string></field>
      <field name="displayName"><string>Dashboard</string></field>
      <field name="description"><string>Dashboard</string></field>
      <field name="accessPermissions">
        <collection type="java.util.ArrayList" item-type="java.lang.String">													
					<value><string>*:/platform/users</string></value>													
        </collection>
      </field>                 	
      <field  name="applications">
        <collection type="java.util.ArrayList">
          <value>
            <object type="org.exoplatform.application.registry.Application">
              <field name="categoryName"><string>dashboard</string></field>
              <field name="applicationName"><string>DashboardPortlet</string></field>
		          <field name="displayName"><string>Dashboard Portlet</string></field>
		          <field name="description"><string>Dashboard Portlet</string></field>
              <field name="applicationType"><string>portlet</string></field>
              <field name="applicationGroup"><string>dashboard</string></field>
              <field name="accessPermissions">
				        <collection type="java.util.ArrayList" item-type="java.lang.String">													
									<value><string>*:/platform/users</string></value>													
				        </collection>
		          </field>
            </object>
          </value>
          <value>
            <object type="org.exoplatform.application.registry.Application">
              <field name="categoryName"><string>dashboard</string></field>
              <field name="applicationName"><string>GadgetPortlet</string></field>
		          <field name="displayName"><string>Gadget Wrapper Portlet</string></field>
		          <field name="description"><string>Gadget Wrapper Portlet</string></field>
              <field name="applicationType"><string>portlet</string></field>
              <field name="applicationGroup"><string>dashboard</string></field>
              <field name="accessPermissions">
				        <collection type="java.util.ArrayList" item-type="java.lang.String">													
									<value><string>*:/platform/users</string></value>													
				        </collection>
		          </field>
            </object>
          </value>
        </collection>
      </field>
    </object>
  </object-param>

{code}